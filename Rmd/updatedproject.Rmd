---
title: "Alewife Migration"
authors: "Danni Harper, Jillian Hunt, Jessie Lilly"
date: "February 12, 2018"
output: html_document



---
```{r}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<<<<<<< HEAD

# **Background:** 

Alewife, *Alosa pseudoharengus* (A. Wilson, 1811) is an anadromous species that is found along the Eastern coast of North America, migrating as far north as Newfoundland (Bigelow and Schroeder 1953). Alewife live to 10 years of age and begin spawning at the age of 3. Alewife can spawn up to 5 times throughout its life. Spawning begins in April or May, with the run reaching a peak in early June (DFO 2007). Alewife spawn upriver in stillwater, spending 13-14 days in the spawning ground before returning to sea (DFO,2007; Andrews 2014). 

The data for our study were collected from Amherst fishway and Missaquash fishway between April- June (2013-2017). The Amherst fishway is located just outside of Amherst, Nova Scotia and the Missaquash fishway is located on the border between Nova Scotia and New Brunswick, both fishways are Denil style fishways (Andrews 2014). For this study, Alewives were obtained using fyke nets and were transferred to a holding pen where measurements were taken, which included: fork length, total length, weight and sex. A small incision was made anterior to the anal fin and Pit tags were inserted into the abdominal cavity(Andrews 2014). Reader boxes were installed directly below each fishway to monitor PIT tagged Alewife passage frequency during their spawning run.

In a previous study it was noted that the passage of an Alewife over Missasquash and Ahmerst fish ways was positively correlated with the size of the fish (Andrews 2014). Larger fish were also more likely to overcome the barriers than smaller fish (Andrews 2014). It was also noted that Alewives often struggled to make it past the fish passages on their first attempt (Andrews 2014). This is hypothesized to occur because some fish do not have enough stored energy to overcome the barrier (Task and Fisher 1977). This suggests that these fishways may prevent Alewife from having successful spawning runs in the Ahmerst and Missaquash rivers. 



# **References**

Andrews, S.N. 2014. Fishway Efficiency and Passage Behavior of Alewife in Three        Fishways on Tantramar Marsh Near Amherst, Nova Scotia. Thesis.
Bigelow, H.., and Schroeder, W.C. 1953. Fishes of the Gulf of Maine. Fish. Bull. Fish  Wildl. Serv. 53. Available from http://www.gma.org/fogm/Microgadus_tomcod.htm.
DFO. (2007). Assessment of Gasperaue River Alewife. DFO Can. Sci. Advis. Sec. Sci.     Advis. Rep. 2007/030.
Task, S.., and Fisher, J.. 1977. Performance of Arctic Grayling in a twenty-foot       section model “A” Alaska Steeppass fish ladder. Final Rep. US Army Corps Eng. Alsk.    Div. Anchorage.




# **Questions**

Since it appears that larger fish are more successful than smaller fish at completing migrations over fishways, the objective of this analysis will be to: 

1. Is there a relationship between forklength of fish and sex? 
2. Is there a relationship between sex, migration time and size class?
3. Is there a difference between type of fishway and size of fish? 



# **Variables:** 
fl= forklength
tl=taillength
sx=sex
tl/fl= tail length to fork length ratio
w=weight
p= pit tag
h= hour
min= minute
d=day
m= month
y=year 
site= 
cblc: Ahmerst river tidal gate
ms: Missassguash tidal gate 

# **Data Tidying**
# We initially checked the status of each column and noted that pit was read in as an integer.


parsing failure: pit = double; sx = integer; sp = integer; site = integer...WHY? Check the status of each column. 

```{r}
library("tidyverse")


sapply(alewife17,class)

alewife17 <- read.csv("alewife13_17.csv", na = c("na", "NA"))
names(alewife17)

sapply(alewife17,class)



```

##We then changed the pit column from numeric to a character vector

```{r}

alewife17$pit <- as.character(alewife17$pit)
```

##Filter only 2017 data 

```{r}
alewife17.df <- filter(alewife17, y==2017)
```



Fill in missing values


```{r}

alewife17.df %>%
  count(sx)

```

```{r}
aw.df <- mutate(alewife17.df, 
                sex = toupper(str_trim(sx)), 
                sex = ifelse(sex %in% c("-","?", "NA"), "U", sex))
# check
with(aw.df, table(sex, sx))
```

Remove sx column from aw.df

```{r}
aw.df$sx <- NULL
```

Change na to a missing value in w

```{r}
aw.df <- mutate(aw.df,w = ifelse(w %in% c("na"), "NA", w))
View(aw.df)
```

Below is a scatterplot displaying the relationship between forklength versus weight of Alewives grouped by sex. I am not sure why the numbers on the x axis are not displaying correctly. 
 
```{r}
ggplot(data= aw.df,mapping= aes(x=w,y=fl,colour=sex),position="jitter")+
  geom_point()+
  ggtitle("Fork length versus Weight for Alewives")+
  xlab("Weight(g)")+
  ylab("Fork length(fl)")

#can't get the x axis to work...
```

```{r}
library(lubridate)

aw.df %>%
  mutate(month=month(m,label=TRUE)) %>%
  ggplot(aes(x=m))+
  geom_bar()+
  ggtitle("Month vs. Passage of Alewife Through Ahmerst and Missaquash Fishway")+
  xlab("Month")+
  ylab("Count")
```
```{r}

aw.df <- aw.df %>%
  mutate(enter = make_date(y, m, d))

ggplot(aw.df, aes(enter))+
  geom_histogram(aes(fill = sex), binwidth = 1)+
  xlab("Date")+
  ylab("Number of Fish")

```
```{r}
aw.df <- aw.df %>%
  mutate(length = ntile(tl, 10))

View(aw.df)
```


## Change NA values to U

```{r}
aw.df.2 <- mutate(aw.df,sex = ifelse(sex %in% c("NA"),"U", sex))
```




## Graph of the relationship between forklength and sex. 

```{r}



ggplot(data=aw.df.2,mapping=aes(x=sex,y=fl))+
  geom_boxplot()+
  ggtitle("Relationship between Forklength and Sex")+
  xlab("Sex")+
  ylab("Forklength")


```

=======
## 1. Is there a relationship between forklength of fish and sex? ?

## First check to see if TL is normally distributed 
## Taillength appears to be normally distributed

```{r}
ggplot(data=aw.df,aes(aw.df$fl))+
  geom_histogram()

``

